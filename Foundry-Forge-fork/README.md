# Foundry Fork + Ethernal åŒºå—æµè§ˆå™¨

ğŸš€ ä¸€ä¸ªå®Œæ•´çš„ä»¥å¤ªåŠæœ¬åœ°å¼€å‘ç¯å¢ƒï¼Œé›†æˆäº† Foundry å·¥å…·é“¾å’Œ Ethernal åŒºå—æµè§ˆå™¨ã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æä¾›äº†ä¸¤ç§å¯åŠ¨æ–¹å¼ï¼š
- **çº¯ Fork ç½‘ç»œ**ï¼šè½»é‡çº§çš„ Anvil fork ç¯å¢ƒ
- **Fork + æµè§ˆå™¨**ï¼šé›†æˆ Ethernal å¯è§†åŒ–ç•Œé¢çš„å®Œæ•´å¼€å‘ç¯å¢ƒ

## ğŸ¯ Ethernal å·¥ä½œåŸç†è¯´æ˜

### âš ï¸ é‡è¦æ¾„æ¸…

**Ethernal ä¸æ˜¯ä¼ ç»Ÿçš„åŒºå—é“¾æµè§ˆå™¨ï¼**

- âŒ **ä¸ä¼šæ˜¾ç¤º** ä»¥å¤ªåŠä¸»ç½‘çš„å†å²æ•°æ®
- âŒ **ä¸ä¼šæ˜¾ç¤º** Vitalik ç­‰åœ°å€åœ¨ä¸»ç½‘çš„äº¤æ˜“è®°å½•
- âŒ **ä¸ä¼šæ˜¾ç¤º** ä¸»ç½‘ä¸Šçš„ DeFi åè®®æ´»åŠ¨
- âœ… **åªæ˜¾ç¤º** ä½ æœ¬åœ° Anvil ç½‘ç»œçš„æ–°æ´»åŠ¨
- âœ… **åªæ˜¾ç¤º** ä½ éƒ¨ç½²çš„åˆçº¦å’Œå‘é€çš„äº¤æ˜“
- âœ… **åªæ˜¾ç¤º** ä»å¯åŠ¨ Ethernal ä¹‹åçš„æ“ä½œ

### ğŸ—ï¸ æ¶æ„åŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Anvil Fork    â”‚â”€â”€â”€â–¶â”‚  Ethernal CLI    â”‚â”€â”€â”€â–¶â”‚ Ethernal Dashboard  â”‚
â”‚  (æœ¬åœ°ç½‘ç»œ)      â”‚    â”‚  (æ•°æ®æ”¶é›†å™¨)     â”‚    â”‚   (Web ç•Œé¢)        â”‚
â”‚                 â”‚    â”‚                  â”‚    â”‚                     â”‚
â”‚ - Fork ä¸»ç½‘çŠ¶æ€  â”‚    â”‚ - ç›‘å¬æœ¬åœ° RPC   â”‚    â”‚ - æ˜¾ç¤ºæœ¬åœ°æ´»åŠ¨      â”‚
â”‚ - å¯æŸ¥è¯¢å†å²     â”‚    â”‚ - æ”¶é›†æ–°äº¤æ˜“     â”‚    â”‚ - åªæ˜¾ç¤ºæ–°æ“ä½œ      â”‚
â”‚ - æ”¯æŒ cast æŸ¥è¯¢â”‚    â”‚ - åŒæ­¥åˆ°äº‘ç«¯     â”‚    â”‚ - åˆçº¦äº¤äº’ç•Œé¢      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š å®é™…ä½¿ç”¨åœºæ™¯

**é€‚åˆ Ethernalï¼š**
- ğŸ”§ æŸ¥çœ‹ä½ éƒ¨ç½²çš„åˆçº¦çŠ¶æ€
- ğŸ“ˆ ç›‘æ§ä½ çš„æµ‹è¯•äº¤æ˜“
- ğŸ•µï¸ è°ƒè¯•åˆçº¦äº¤äº’è¿‡ç¨‹
- ğŸ‘¥ å›¢é˜Ÿå…±äº«å¼€å‘ç¯å¢ƒçŠ¶æ€

**éœ€è¦ç”¨ cast å‘½ä»¤ï¼š**
- ğŸ” æŸ¥è¯¢ Fork çŠ¶æ€ä¸‹çš„å†å²ä½™é¢
- ğŸ“Š è°ƒç”¨ä¸»ç½‘åˆçº¦çš„å†å²çŠ¶æ€
- ğŸ’° æŸ¥çœ‹çŸ¥ååœ°å€çš„ ETH/ä»£å¸ä½™é¢

**æŸ¥çœ‹çœŸå®ä¸»ç½‘æ•°æ®ï¼š**
- ğŸŒ ä½¿ç”¨ [Etherscan](https://etherscan.io)
- ğŸ” ä½¿ç”¨å…¶ä»–ä¸»ç½‘åŒºå—æµè§ˆå™¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£… Foundry
curl -L https://foundry.paradigm.xyz | bash
foundryup

# å®‰è£… Ethernal
npm install -g ethernal

# å…‹éš†é¡¹ç›®
git clone <your-repo-url>
cd Foundry-Forge-fork
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim .env
```

**å¿…å¡«é…ç½®ï¼š**
```bash
# RPC é…ç½® (æ¨èä½¿ç”¨ Alchemy)
MAINNET_RPC_URL=https://eth-mainnet.g.alchemy.com/v2/YOUR_API_KEY

# Fork åŒºå—é…ç½®
FORK_BLOCK_NUMBER=18500000  # æˆ–ä½¿ç”¨ latest

# Ethernal ç™»å½•ä¿¡æ¯ (åœ¨ app.tryethernal.com æ³¨å†Œ)
ETHERNAL_EMAIL=your@email.com
ETHERNAL_PASSWORD=yourpassword
```

### 3. å¯åŠ¨æœåŠ¡

#### æ–¹å¼ 1ï¼šçº¯ Fork ç½‘ç»œï¼ˆæ¨èç”¨äºæ€§èƒ½æµ‹è¯•ï¼‰

```bash
./start_fork.sh
# æˆ–æŒ‡å®šå‚æ•°
./start_fork.sh mainnet 19000000 8545
```

#### æ–¹å¼ 2ï¼šFork + Ethernal æµè§ˆå™¨ï¼ˆæ¨èç”¨äºå¼€å‘è°ƒè¯•ï¼‰

```bash
./start_ethernal.sh
```

### 4. æµ‹è¯•ç½‘ç»œ

```bash
# æµ‹è¯•åŸºæœ¬è¿æ¥
./test_fork.sh

# æ‰‹åŠ¨æŸ¥è¯¢ä½™é¢ï¼ˆæŸ¥è¯¢ Fork çŠ¶æ€ä¸‹çš„å†å²æ•°æ®ï¼‰
cast balance 0xd8da6bf26964af9d7eed9e03e53415d37aa96045 --rpc-url http://localhost:8545

# éƒ¨ç½²æµ‹è¯•åˆçº¦
forge script script/Counter.s.sol:CounterScript --rpc-url http://localhost:8545 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 --broadcast
```

### 5. æŸ¥çœ‹ç»“æœ

- **å‘½ä»¤è¡ŒæŸ¥è¯¢**ï¼šä½¿ç”¨ `cast` å‘½ä»¤æŸ¥è¯¢ä»»ä½•åœ°å€/åˆçº¦çŠ¶æ€
- **Ethernal ç•Œé¢**ï¼šè®¿é—® [https://app.tryethernal.com/](https://app.tryethernal.com/) æŸ¥çœ‹ä½ çš„æœ¬åœ°æ´»åŠ¨

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ .env                 # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ start_fork.sh        # çº¯ Anvil fork å¯åŠ¨è„šæœ¬
â”œâ”€â”€ start_ethernal.sh    # Anvil + Ethernal å¯åŠ¨è„šæœ¬
â”œâ”€â”€ stop_ethernal.sh     # åœæ­¢æ‰€æœ‰æœåŠ¡
â”œâ”€â”€ test_fork.sh         # ç½‘ç»œæµ‹è¯•è„šæœ¬
â”œâ”€â”€ script/
â”‚   â”œâ”€â”€ Counter.s.sol    # ç¤ºä¾‹éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ Deploy.s.sol     # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ Counter.sol      # ç¤ºä¾‹åˆçº¦
â”‚   â””â”€â”€ ForkTester.sol   # Fork æµ‹è¯•åˆçº¦
â””â”€â”€ test/
    â”œâ”€â”€ Counter.t.sol    # åˆçº¦æµ‹è¯•
    â””â”€â”€ ForkTest.t.sol   # Fork æµ‹è¯•
```

## ğŸ”§ ç»Ÿä¸€é…ç½®

ä¸¤ä¸ªå¯åŠ¨è„šæœ¬ä½¿ç”¨**å®Œå…¨ç›¸åŒçš„ Anvil å‚æ•°**ï¼š

```bash
anvil \
    --fork-url "$RPC_URL" \
    --fork-block-number "$BLOCK_NUMBER" \
    --port 8545 \
    --host 0.0.0.0 \
    --accounts 10 \
    --balance 10000 \
    --gas-limit 300000000 \
    --code-size-limit 50000 \
    --base-fee 0 \
    --gas-price 0
```

## ğŸ“Š æµ‹è¯•è´¦æˆ·

é»˜è®¤æä¾› 10 ä¸ªæµ‹è¯•è´¦æˆ·ï¼Œæ¯ä¸ªè´¦æˆ·æœ‰ 10000 ETHï¼š

```
Account #0: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
Account #1: 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
Account #2: 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
...

Private Key #0: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
```

## ğŸ¯ ä½¿ç”¨æŠ€å·§

### æŸ¥è¯¢å†å²çŠ¶æ€

```bash
# æŸ¥è¯¢çŸ¥ååœ°å€ä½™é¢ï¼ˆFork æ—¶çš„çŠ¶æ€ï¼‰
cast balance 0xd8da6bf26964af9d7eed9e03e53415d37aa96045 --rpc-url http://localhost:8545

# æŸ¥è¯¢ USDC ä½™é¢
cast call 0xA0b86a33E6417c752e2c4494b79E3e48Cd90f263 "balanceOf(address)" 0xd8da6bf26964af9d7eed9e03e53415d37aa96045 --rpc-url http://localhost:8545

# è°ƒç”¨ä»»ä½•ä¸»ç½‘åˆçº¦
cast call 0xContract_Address "functionName()" --rpc-url http://localhost:8545
```

### å‘é€æµ‹è¯•äº¤æ˜“

```bash
# è½¬è´¦ ETH
cast send --value 1ether 0xRecipient_Address --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 --rpc-url http://localhost:8545

# è°ƒç”¨åˆçº¦å‡½æ•°
cast send 0xContract_Address "functionName()" --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 --rpc-url http://localhost:8545
```

## ğŸ›‘ åœæ­¢æœåŠ¡

```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
./stop_ethernal.sh

# æˆ–æ‰‹åŠ¨åœæ­¢
pkill -f anvil
pkill -f ethernal
```

## â“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆ Ethernal æ˜¾ç¤ºä¸äº† Vitalik çš„äº¤æ˜“ï¼Ÿ
A: Ethernal åªæ˜¾ç¤ºæœ¬åœ°ç½‘ç»œçš„**æ–°æ´»åŠ¨**ï¼Œä¸ä¼šæ˜¾ç¤º Fork æ—¶çš„å†å²æ•°æ®ã€‚è¦æŸ¥è¯¢å†å²çŠ¶æ€è¯·ä½¿ç”¨ `cast` å‘½ä»¤ã€‚

### Q: å¦‚ä½•æŸ¥çœ‹ä¸»ç½‘çš„å®æ—¶æ•°æ®ï¼Ÿ
A: è¯·ä½¿ç”¨ [Etherscan](https://etherscan.io) ç­‰ä¸»ç½‘åŒºå—æµè§ˆå™¨ã€‚

### Q: ä¸ºä»€ä¹ˆéœ€è¦æ³¨å†Œ Ethernal è´¦å·ï¼Ÿ
A: Ethernal ä½¿ç”¨äº‘ç«¯ Dashboard æä¾› Web ç•Œé¢ï¼Œæœ¬åœ° CLI åªæ˜¯æ•°æ®æ”¶é›†å™¨ã€‚

### Q: å¦‚ä½•æ›´æ”¹ Fork çš„åŒºå—é«˜åº¦ï¼Ÿ
A: ä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„ `FORK_BLOCK_NUMBER` å€¼ï¼Œç„¶åé‡å¯æœåŠ¡ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æ³¨æ„**ï¼šæœ¬é¡¹ç›®ä»…ç”¨äºå¼€å‘å’Œæµ‹è¯•ç›®çš„ï¼Œè¯·å‹¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚
